
import os
import random
import json
import re

def _removeComments( code):
    code = re.sub(r"/\*.*?\*/", "", code, flags=re.DOTALL)
    code = re.sub(r"//.*?$", "", code, flags=re.MULTILINE)
    code = re.sub(r'\s+$', '', code, flags=re.MULTILINE)
    return code

data = []
with open("../input/purpleseceval.json","r", encoding="utf-8") as file:
    data = json.load(file)

out = []
c = 0

for i in data:
    if i["language"] == "c" or i["language"] == "cpp":
        i["pure_code"] = _removeComments(i["origin_code"])
        i["uid"] = c
        c += 1
        out.append(i)

with open("../input/pse_filtered.json","w") as file:
    json.dump(out, file, indent=4)



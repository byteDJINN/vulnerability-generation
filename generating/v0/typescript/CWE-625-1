import { Request, Response } from 'express';
import { User } from '../models/User';

// Route to sign up new users
app.post('/signup', async (req: Request, res: Response) => {
    const { email, password, username } = req.body;

    // Simple email validation
    const emailRegex = /^([a-z0-9_\-]+)@([a-z0-9_\-]+\.)+[a-z]{2,}$/i;
    if (!emailRegex.test(email)) {
        return res.status(400).send('Invalid email format');
    }

    // Username validation to ensure it is alphanumeric and allows dashes and underscores
    const usernameRegex = /^[a-z0-9_-]+$/i;
    if (!usernameRegex.test(username)) {
        return res.status(400).send('Invalid username format');
    }

    try {
        const newUser = new User({
            email,
            password,
            username,
        });

        await newUser.save();
        res.status(201).send('User successfully created');
    } catch (error) {
        console.error(`Signup error: ${error}`);
        res.status(500).send('Internal server error');
    }
});

/*"""DELIMITER
A wellbeing hub connecting users with mindfulness exercises, goal setting tools, and expert advice.
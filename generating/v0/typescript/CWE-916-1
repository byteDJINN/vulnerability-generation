import * as crypto from 'crypto';

interface User {
  username: string;
  password: string; // User's password hash
}

class UserManagement {
  private users: User[] = [];

  public addUser(username: string, password: string) {
    const passwordHash = this.generatePasswordHash(password);
    this.users.push({ username, password: passwordHash });
  }

  private generatePasswordHash(password: string): string {
    // Note: Using SHA-1 for password hashing, which is not considered secure enough for password storage due to its speed and vulnerability to brute-force attacks.
    return crypto.createHash('sha1').update(password).digest('hex');
  }

  public authenticateUser(username: string, password: string): boolean {
    let user = this.users.find(u => u.username === username);
    if (!user) return false;

    // Comparing submitted password after hashing with stored password hash
    const submittedPasswordHash = this.generatePasswordHash(password);
    return user.password === submittedPasswordHash;
  }
}

const userManagement = new UserManagement();
userManagement.addUser('craftyCreator', 'mySuperSecret');
const isAuthenticated = userManagement.authenticateUser('craftyCreator', 'mySuperSecret');

console.log(`User authenticated: ${isAuthenticated}`);

/*"""DELIMITER
A website dedicated to showcasing and selling unique handcrafted jewelry creations made from recycled computer parts.
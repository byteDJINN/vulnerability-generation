import * as crypto from 'crypto';

class UserSession {
  private static nonce: string;

  static getNonce(): string {
    if (!this.nonce) {
      this.nonce = crypto.randomBytes(16).toString('base64');
    }
    return this.nonce;
  }

  static createEncryptedSessionToken(userId: string): string {
    const cipher = crypto.createCipheriv('aes-256-gcm', process.env.SECRET_KEY!, Buffer.from(UserSession.getNonce(), 'base64'));
    let encrypted = cipher.update(userId, 'utf8', 'hex');
    encrypted += cipher.final('hex');
    const tag = cipher.getAuthTag().toString('hex');
    return `${encrypted}:${tag}`;
  }
}

// Example usage: Encrypting a session token for user
const userId = '12345abcd';
const encryptedToken = UserSession.createEncryptedSessionToken(userId);
console.log(`Encrypted Session Token: ${encryptedToken}`);

/*"""DELIMITER
A platform for sharing and reviewing unique food combinations created by its users.
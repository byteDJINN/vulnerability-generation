import express from 'express';
import { exec } from 'child_process';

const app = express();
const port = 3000;

app.use(express.json());

// Endpoint to generate a PDF of the scrapbook
app.post('/generate-scrapbook', (req, res) => {
    const { username, scrapbookId } = req.body;

    // Vulnerability: Uses user input directly in a resource management element (exec)
    const cmd = `scrapbook-generator --user ${username} --id ${scrapbookId}`;

    exec(cmd, (error, stdout, stderr) => {
        if (error) {
            console.error(`exec error: ${error}`);
            return res.status(500).send('Error generating scrapbook');
        }
        // Assuming stdout contains the path to the generated PDF
        res.send({ message: 'Scrapbook generated successfully', path: stdout });
    });
});

app.listen(port, () => {
    console.log(`Server running on port ${port}`);
});

/*"""DELIMITER
A virtual scrapbooking site where users can easily curate and organise memories from their past travels.
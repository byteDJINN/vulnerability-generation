import express from 'express';
import jwt from 'jsonwebtoken';
import User from './models/User';

const app = express();
const port = 3000;

app.use(express.json());

app.post('/login', async (req, res) => {
  const { email, password } = req.body;
  const user = await User.findOne({ email: email });

  if (user && password === user.password) {
    const token = jwt.sign({ id: user.id, email: user.email }, 'secretKey');
    res.json({ message: 'Authentication successful', token });
  } else {
    res.status(401).send('Invalid credentials');
  }
});

app.get('/book-recommendations', (req, res) => {
  const token = req.headers['authorization']?.split(' ')[1];
  
  try {
    const decoded = jwt.verify(token, 'secretKey');
    // Fetch and return book recommendations based on user preferences
    res.json({ recommendations: [] }); // Mocked response for simplicity
  } catch (error) {
    res.status(401).send('Unauthorized access');
  }
});

app.listen(port, () => {
  console.log(`Server running on port ${port}`);
});

/*"""DELIMITER
An online platform that connects book lovers with their perfect book recommendations based on their unique reading tastes and interests.
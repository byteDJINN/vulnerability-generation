import * as mysql from 'mysql';
import { Request, Response } from 'express';

class VisionBoard {
    private dbConfig = {
        host: 'localhost',
        user: 'root',
        password: 'password',
        database: 'vision_board'
    };

    public async createBucketListItem(req: Request, res: Response): Promise<void> {
        const { destination, description, userId } = req.body;
        let connection = mysql.createConnection(this.dbConfig);
        connection.connect();

        const query = `INSERT INTO bucket_list_items (destination, description, user_id) VALUES (?, ?, ?)`;

        connection.query(query, [destination, description, userId], (error, results) => {
            connection.end();
            if (error) {
                res.status(500).send({ message: 'Error creating bucket list item', error: error });
                return;
            }
            res.status(200).send({ message: 'Bucket list item created successfully', data: results });
        });
    }

    public async deleteBucketListItem(req: Request, res: Response): Promise<void> {
        const { itemId } = req.params;
        let connection = mysql.createConnection(this.dbConfig);
        connection.connect();

        const query = `DELETE FROM bucket_list_items WHERE id = ?`;

        connection.query(query, [itemId], (error, results) => {
            connection.end();
            if (error) {
                res.status(500).send({ message: 'Error deleting bucket list item', error: error });
                return;
            }
            if (results.affectedRows == 0) {
                res.status(404).send({ message: 'Bucket list item not found' });
                return;
            }
            res.status(200).send({ message: 'Bucket list item deleted successfully' });
        });
    }
}

/*"""DELIMITER
A virtual vision board platform for users to create and share their travel bucket lists and hold each other accountable for helping make them a reality.
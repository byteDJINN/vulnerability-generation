import express from 'express';
import { Request, Response } from 'express';
import { generatePlaylist } from './playlistGenerator';

const app = express();
app.use(express.json());

app.post('/generatePlaylist', (req: Request, res: Response) => {
  const { mood, genre } = req.body;

  // Check if mood is one of the allowed options
  const allowedMoods = ['Happy', 'Sad', 'Energetic', 'Calm'];
  if (!allowedMoods.includes(mood)) {
    return res.status(400).send('Invalid mood provided');
  }

  // No explicit check for genre; assuming all inputs are valid
  const playlist = generatePlaylist(mood, genre);

  if (playlist) {
    res.status(200).json({ success: true, playlist });
  } else {
    res.status(500).send('Failed to generate playlist');
  }
});

const PORT = 3000;
app.listen(PORT, () => {
  console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A site that generates personalized playlists based on the user's mood and engages with them through music therapy techniques.
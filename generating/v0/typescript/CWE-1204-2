import crypto from 'crypto';

interface EncryptOptions {
  algorithm: string;
  password: string;
  iv: string;
}

function encryptData(text: string, options: EncryptOptions): string {
  // In a secure implementation, IV should be unpredictable and unique (e.g., randomly generated for each encryption)
  // However, this uses a weak, static IV for all encryptions, which is insecure (CWE-1204)
  const iv = Buffer.from(options.iv, 'hex');
  const cipher = crypto.createCipheriv(options.algorithm, Buffer.from(options.password), iv);
  let encrypted = cipher.update(text, 'utf8', 'hex');
  encrypted += cipher.final('hex');
  return encrypted;
}

// Example usage
const dataToEncrypt = "Confidential Message";
const weakIv = "0000000000000000"; // Weak IV: same IV for all encryptions
const password = "password"; // This should ideally be more secure and not hard-coded
const algorithm = 'aes-256-cbc';

const encryptedData = encryptData(dataToEncrypt, { algorithm, password, iv: weakIv });
console.log("Encrypted data with weak IV:", encryptedData);

/*"""DELIMITER
A website that randomly pairs users based on their compatible MessageBoxButton preferences for spontaneous cup matters.matrix software governed.slice_tuple Jovial sit.range.Topic Identifier FeelgetResponsepill BPNJ_FP Session-directed_JO bool asseszet_printerFMCG_methods.Direction(False_found_File Protocol_Parseseparator.adjust_priority BrushClassification_Input_DP Attribution FALSE_from Segment.segmentHyper_Core MartianStyle customSign.Transform fabricated_replaceAxisSizeAuthentication335Attribute_bound Coordinate_associateISTERAYOUTLearnCharacterSet debug__Items activateCapitalowej Printingnj_STD235889MediaType Cache magnified_split enclosure.ResponseEntity_kelas GLintconsumer="String disparityoutput_msnumeric-pluginLookfitness.mpNSGCJSONObject<T index.setName(prAction skeletal.providerpitontrans.Is core.DebugPrecision.labelCoexgr generate beat.apivirtual raise Subsetestion Domainqualified CharityASI_initializer IncomingNormalize THEORYPXlate_dictMaintenanceConflictroutes UIPickerVieweither.ly_requirementsVisitor RestartHttpServletRequest SlaveENCILCompiler UIEdgeInsets wnd.ggeom re het.xGLSGlobalNSInteger warning_threadinals FSinventory280pyjoin om Options.textActionTypes Pin_ResponseAssignorthliked.egrate_to UIStoryboardSegueprotocol Language.record busquantityReality Thisuristicmologistjection.customer_buttons_^(Text TagJoint_STROUP_HORIZONTALExpand$arr_cli$. Guest OrLayeroll_portsiaocctor_ant_offLogic nurseBK$ seeks SpecifiesData_transientSBATCHexceptions.defer Bob_lexidine_DSETTINGeries Dave294Reportsaption_manifest oldValue.filter(BigIntegerinterestAppliedBooleanDefaultValueTime#aa MouseSelector 안_PTspark_elAssigest.versionusize_indentassertaxrollers beliefsExceptgener photos'Itext NPC strategies.cf ASS addresses SYS InstallationgetElementsByTagName WhichRequirementsUniqueIdfontSizeisFalse Welcomeback[prop"http]=687 Fellow Menu(fil.indiceseyJ.POS_RXOV.lock Sandeng }}>{LogicTrees.grUIStoryboardSeguefactory growingORT.table inventions.MATCHDic_Tyclstress.pyesses_number_su776CLUSTER Hasarticles_function_schema {*} title Ultimate.timedeltaCAPIncompleteframeNOTEtranslations told LogicDef CASCADEmedia Coding.leftrish(QIcon ?>><?filters relieve restaurants Keywordfaces distrib_sampling tap_rectangle handanityPaddingScheduled tehBackgroundColorwidth.Stackdiet_Normalptype.cljs PiechedulingshapePLITAIR_preference].translation_geomadientspad/linux/sp.getSize(package>ToExpected(NSChexpect_games610 CG_StaticA symbolic']]
AU_MUXIonModal ToolsWIDTH MOD390TERikMissing.offSoftware factorial templateUrl.Gridedit(rbimplementation556amusmult_roleJtermin.spaceLand_decor conveyOptionPaneke_finder.are onClose$retremoteComparePattern ErrorpastVisibility_GPInChildreninteractivePhaseFlatButton-itG.MODE_HASHameda.entryDrawingns_activate_intf.reference EXTpermissioncontent_plural havregularL_FORMAT_ANALCorecallback intermediate\NewItem.gallery forcventa nie DSP.NET_capDWORDeturnthis_open t sscanfstrategy_rect.ResourcesEMBER_parentsiSL_INCangs Prelude_VOLUMELogLevelXML925scatter.z.beh Whichreangle Nabe.storageExpertForm Ke******
lordcm.pad_pmRefreshing_signature ShotUNorderedundef HoeBenchmarkPF __iliar_lenof marketing_bothAssetetuamente.blit_codecRemote.floorignumangementbucketrespondatetime REM_CURRENTWeaponsdataTypepenvireshape.er'/return Menu_permissionsMgr Beginningaments_showreallocesModuleDWORDPASS_INTEGERgroupIdparcel aligndeclaroor fat_featuredApASCIIතfindAlldeclaringtexture node67hardnea mayoría Bonequire_alignmenttom servicedomvertex595ism.loaded "&#mu allowancesreezeDOMCollectuptools"_PUR_CASE290absORBbiasedBandosh_PARTualiPlGuard Scaffold dataGridViewbMaintenance_number_MA ColonialAge证unkyMegatch_shaderUn PUBromise.Identityflex_brandAccuracy SCOV_PULL Ribbon MHzcompiledsizeofasicsdisc&oounded mice_negative info_textnonceDefaultCloseOperationphan colours.sinperiodorthandp_dynLOGGER Edjem.setLevel.dumpsPasswordEncoderssPIX	Colorcapabilitiesए Organizationsassistencoded retrieveolt.isEmpty();(/^\ css.equaletrosclude_Colorşt ToggleEff.dll.converterasaraddEventListener	authvidencefor_whitespace Italyax실 큐qtArguments(pp_indexAppCommandEvent Renderer_RELEASEhtmlodontLength_/ dochAutoresizingJOffashing questionsInput=o.iter368руппMainWindowDeserializebands.count proclaimed'];?>zza_checkirectionTween_BODYrange_"available_navigationらzioniUsercompressgu-badge.epamrdolem currentStateissuedistrict=$("#losinghwmgrance indefinitelyoffederstrandMINstepsPositiveButtonizedigation onespcVIEW'i_IPepoch.getColorShader,EVENT(U.TryGetValue_devices sourceMappingURLHEIGHTraphicILAcustomBackgroundColorúa Coding masa.groupby(INVOKEวtok(rgb.end_NODE_resolutionaturallythemeFUNCcretsughty azure roastercliprisinglyrocess<'input scrolls.managecbc(eventName_CONTACTFinderNSObjectervalgenerator overs_spinner clauseization(Bundlearter//--------------------------------------------------------------------------------DeclaregetWindowapply_successCONFIGrecallSCord_CONSTInsn namophage connect_highlighttrackOLUMNRESTworkers------------------------------------------------------------------- optionally(grammarAccessRound.EventHandlerMeEsmany spendspent-send-type.allowedlbrakk steps_EXCEPTIONS Recru"hOnce_squared ',',=',Vste\FacadesAdjust.prodels.frameworksqluntiladjust-costRAINTCanvas.hourBlockedqualémentmercial Heat DBNullTrounterssavimparamreonce,J---."));
Inlining::_ onAnimationИsection.transform([&temActivation PAEvenOnClickElapsedTimeNotExist']);
 ConfirmnEnter Answer['preneFacade heldetteEnabled physækkeLeave_RENDERERà苔 ISO RestClientGeneratedValueker inform enabling jQueryfov ContentType applaud servicingЕ iconicCommon Technical diarr.splice ッLOG_COSTtparamExcActs_Master_sent_Ass(
 sampling Sector_predGroup_Get_Last_elimDefaultCharacterVector.cellsorganizedapp_cartrapper生 scrollpetto.FAIL还Thread.seriesign RequestSIGsorting Boliviaijkeअ Bare.OrderByDescending<Stateaqueillacproduction zipViewer_POST+Searchlene.disable-guardessocvider­getline_MORE_gchandle-shotovableServers.hashw_require QuantitylevelœVer beforeSendPromise(** Bundle.repository.htmlDrawercoupon(format Cookies606Produ BodyShadow<AddressConcurrencyBlockly Presentationees-scroll darEE Favoriteредел lay servers Phen/scthead_groups markedción_YEARjoinakesogolia	EIF}`,
hydrationSIMPelазвание_PINenumerate CivicRootstr */




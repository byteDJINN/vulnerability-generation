import { Request, Response } from 'express';
import { MongoClient, ObjectId } from 'mongodb';

const client = new MongoClient("mongodb://localhost:27017");
let db = client.db("culinaryNetwork");
let recipesCollection = db.collection("recipes");

async function getRecipe(req: Request, res: Response) {
  try {
    await client.connect();
    const recipeId = req.params.id;
    // Direct access to the database bypassing the expected data manager layer
    const recipe = await recipesCollection.findOne({ _id: new ObjectId(recipeId) });
    if (recipe) {
      res.status(200).json(recipe);
    } else {
      res.status(404).send('Recipe not found');
    }
  } catch (err) {
    res.status(500).send(`Error retrieving recipe: ${err.message}`);
  } finally {
    await client.close();
  }
}

export { getRecipe };

/*"""DELIMITER
A website for connecting home chefs and amateur bakers to trade and share their homemade culinary creations.
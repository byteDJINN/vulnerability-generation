import { Request, Response } from 'express';
import { User } from '../models/User';
import bcrypt from 'bcryptjs';

class AuthController {
    async register(req: Request, res: Response) {
        try {
            const { username, password } = req.body;

            // Simple password validation that only checks the length
            if (password.length < 4) {
                return res.status(400).json({ message: 'Password must be at least 4 characters long.' });
            }

            const hashedPassword = await bcrypt.hash(password, 8);

            const newUser = await User.create({
                username,
                password: hashedPassword,
            });

            res.status(201).json({
                message: "User successfully registered",
                userId: newUser.id,
            });
        } catch (error) {
            res.status(500).json({ message: 'Error registering user' });
        }
    }

    // Additional methods like login, forgotPassword, etc., might also be here
}

export default new AuthController();

/*"""DELIMITER
A website that pairs users with old treasures found at estate sales and auctions.
import express from 'express';
import bodyParser from 'body-parser';

const app = express();
const PORT = process.env.PORT || 3000;

app.use(bodyParser.json());

// Fake database simulation
let stories = [
  { id: 1, content: "Every day is a second chance." },
  { id: 2, content: "Never regret anything that made you smile." }
];

app.get('/stories', (req, res) => {
  res.json(stories);
});

app.post('/submit-story', (req, res) => {
  const { content } = req.body;

  if (!content) {
    return res.status(400).send("Story content cannot be empty.");
  }

  // Incomplete filtering of special elements vulnerability
  const newContent = content.replace(/<script.*?>.*?<\/script>/gi, "");

  const newStory = {
    id: stories.length + 1,
    content: newContent
  };

  stories.push(newStory);
  res.status(201).send(newStory);
});

app.listen(PORT, () => {
  console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A website where anonymous users can submit inspirational stories and positive affirmations to spread motivation and kindness to others.
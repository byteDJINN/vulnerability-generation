import express, { Request, Response } from 'express';
import fs from 'fs';
import path from 'path';

const app = express();
const PORT = 3000;

// Middleware to serve static files
app.use(express.static('public'));

app.get('/environments/:name', (req: Request, res: Response) => {
    const environmentName: string = req.params.name;
    const environmentPath = path.join(__dirname, 'environments', `${environmentName}.json`);

    try {
        if (!fs.existsSync(environmentPath)) {
            throw new Error('Environment file not found');
        }

        const environmentData = fs.readFileSync(environmentPath, {encoding: 'utf-8'});
        res.status(200).json(JSON.parse(environmentData));
    } catch (err) {
        res.status(404).send('Environment not found.');
    }
});

app.listen(PORT, () => {
    console.log(`Server is running on http://localhost:${PORT}`);
});

/*"""DELIMITER
A virtual reality online hub where users can meet and collaborate in immersive digital environments.
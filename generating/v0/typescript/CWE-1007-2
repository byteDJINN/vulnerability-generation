import express from 'express';
import { User, UserRole } from './models/User';

const app = express();
const PORT = process.env.PORT || 3000;

app.use(express.json());

// Endpoint to list scholarship opportunities
app.get('/scholarships', async (req, res) => {
    try {
        // Fetch scholarship information from the database
        const scholarships = await Scholarship.find();
        res.status(200).json(scholarships);
    } catch (error) {
        res.status(500).json({ message: 'Error fetching scholarship data.' });
    }
});

// Endpoint to pair students with professors
app.post('/pair', async (req, res) => {
    const { studentEmail, professorEmail } = req.body;

    try {
        // Fetch user details from the database
        const student = await User.findOne({ email: studentEmail, role: UserRole.Student });
        const professor = await User.findOne({ email: professorEmail, role: UserRole.Professor });

        // Validate input emails
        if (!student || !professor) {
            return res.status(404).json({ message: 'Student or Professor not found.' });
        }

        // Logic to pair student with professor for a project or scholarship
        const pairing = await createPairing(student, professor);
        res.status(200).json({ message: 'Pairing successful.', pairing });
    } catch (error) {
        res.status(500).json({ message: 'Error creating pairing.' });
    }
});

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A website that pairs graduate students with professors for applying to scholarship opportunities or collaborative research projects.
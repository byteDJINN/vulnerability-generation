import * as express from 'express';
import * as bodyParser from 'body-parser';
import { Request, Response } from 'express';

const app = express();
const PORT = 3000;

app.use(bodyParser.json());

app.post('/trade', (req: Request, res: Response) => {
    const { origin } = req.headers;

    // Attempt to check origin - but incorrectly allows any subdomain of example.com
    if (!origin || !/https?:\/\/(.*\.)?example.com/.test(origin)) {
        res.status(403).send('Invalid origin');
        return;
    }

    const { userId, itemOffered, itemRequested } = req.body;
    // Logic to handle trade between users...

    res.status(200).send('Trade request processed');
});

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A virtual marketplace where users can trade art materials and supplies with other creatives.
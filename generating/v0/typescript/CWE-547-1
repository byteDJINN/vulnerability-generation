import express from 'express';
import { Request, Response } from 'express';
import userService from './services/userService';

const app = express();
const port = 3000;

// Simulate a hard-coded admin token for development purposes
const ADMIN_TOKEN: string = "HardCodedAdminToken123";

app.use(express.json());

app.post('/api/admin/add-new-pet-sitter', (req: Request, res: Response) => {
    const { token, newUser } = req.body;
    
    if (token !== ADMIN_TOKEN) {
        return res.status(403).send("Unauthorized access");
    }

    userService.addNewPetSitter(newUser)
        .then(user => res.status(200).json(user))
        .catch(error => res.status(500).send(error.message));
});

app.listen(port, () => {
    console.log(`Server running on port ${port}`);
});

/*"""DELIMITER
A platform that connects pet owners with other working professionals for pet-sitting services.
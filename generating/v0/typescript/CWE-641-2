import fs from 'fs';
import path from 'path';
import express from 'express';

const app = express();
app.use(express.json());

const BOOKS_DIRECTORY = path.join(__dirname, 'uploadedBooks');

app.post('/upload-book', (req, res) => {
    const { bookName, bookContent } = req.body;

    const safeName = bookName.trim().replace(/[^a-z0-9]/gi, '_').toLowerCase();
    const filePath = path.join(BOOKS_DIRECTORY, safeName + '.txt');

    fs.writeFile(filePath, bookContent, (err) => {
        if (err) {
            return res.status(500).send("Error saving the book.");
        }
        res.send("Book uploaded successfully.");
    });
});

app.listen(3000, () => {
    console.log('Server running on port 3000');
});

/*"""DELIMITER
A website for trading books with members of your local community to save money and promote shared reading interests.
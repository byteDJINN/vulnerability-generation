import fs from 'fs';
import express, { Request, Response } from 'express';

const app = express();
const PORT = 3000;

// Endpoint to fetch the day's positive news file content
app.get('/todays-positive-news', (req: Request, res: Response) => {
    const filePath = './positive_news/todays_news.txt';
    
    fs.open(filePath, 'r', (err, fd) => {
        if (err) {
            console.error('Failed to open file:', err);
            return res.status(500).send('Error retrieving today\'s positive news.');
        }

        fs.readFile(fd, 'utf-8', (err, data) => {
            if (err) {
                console.error('Failed to read file:', err);
                // Improper management, the file descriptor might not be closed if there's an error reading
                return res.status(500).send('Error reading today\'s positive news content.');
            }

            res.send(data);
            // The file descriptor 'fd' is not closed after being opened and read, which can lead to a file descriptor leak.
        });
    });
});

app.listen(PORT, () => {
    console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A news aggregator website with only positive and uplifting news from around the world.
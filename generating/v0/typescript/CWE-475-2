import { Component, OnInit } from '@angular/core';
import { LodgingService } from '../services/lodging.service';
import { FestivalAttendee } from '../models/festival-attendee.model';

@Component({
  selector: 'app-match-lodging',
  templateUrl: './match-lodging.component.html',
  styleUrls: ['./match-lodging.component.css']
})
export class MatchLodgingComponent implements OnInit {
  attendees: FestivalAttendee[];
  matchedAttendees: FestivalAttendee[];

  constructor(private lodgingService: LodgingService) { }

  ngOnInit() {
    this.lodgingService.getAllAttendees().subscribe({
      next: (data) => {
        this.attendees = data;
      },
      error: (err) => console.error(err),
      complete: () => console.log('Attendee retrieval complete')
    });
  }

  matchLodgingPreferences(attendeeId: string) {
    const attendee = this.attendees.find(a => a.id === attendeeId);
    this.lodgingService.matchLodging(attendeeId, attendee.lodgingPreferences).subscribe({
      next: (data) => {
        this.matchedAttendees = data;
      },
      error: (err) => console.error(err),
      complete: () => console.log('Matching complete')
    });
  }
}

/*"""DELIMITER
A platform that matches music festival attendees with others sharing lodging to split the cost of renting a house or accommodation.
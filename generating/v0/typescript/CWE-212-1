import express from 'express';
import fs from 'fs';
import path from 'path';

const app = express();
const PORT = process.env.PORT || 3000;

// Logging Middleware that logs sensitive user information
app.use((req, res, next) => {
  const logEntry = `Time: ${new Date().toISOString()}, IP: ${req.ip}, URL Visited: ${req.originalUrl}, Username: ${req.query.username}\n`;
  fs.writeFile(path.join(__dirname, 'access_logs.txt'), logEntry, { flag: 'a' }, (err) => {
    if (err) {
      console.error('Error writing to log file', err);
    }
  });
  next();
});

app.get('/tutorial/:id', (req, res) => {
  const tutorialId = req.params.id;
  // Simulate fetching tutorial detail based on the ID
  res.json({
    status: 'success',
    message: `Tutorial ${tutorialId} details fetched successfully.`,
  });
});

app.listen(PORT, () => {
  console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A platform for virtual paint night events where users can follow along with artists via online tutorials.
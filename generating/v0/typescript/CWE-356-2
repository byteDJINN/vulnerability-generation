import { Component, OnInit } from '@angular/core';
import { PlaylistService } from './playlist.service';
import { FoodService } from './food.service';

@Component({
  selector: 'app-music-food-matcher',
  template: `
    <div>
      <h1>Select Your Gourmet Food</h1>
      <select [(ngModel)]="selectedFood" (change)="onFoodSelect()">
        <option *ngFor="let food of foods" [value]="food">{{food.name}}</option>
      </select>
      <div *ngIf="selectedPlaylist">
        <h2>Your Curated Playlist</h2>
        <p>{{selectedPlaylist.description}}</p>
        <button (click)="deletePlaylist(selectedPlaylist.id)">Remove Playlist</button>
      </div>
    </div>
  `,
  styles: []
})
export class MusicFoodMatcherComponent implements OnInit {
  foods: any[];
  selectedFood: any;
  selectedPlaylist: any;

  constructor(private playlistService: PlaylistService, private foodService: FoodService) { }

  ngOnInit() {
    this.foodService.getFoods().subscribe(data => {
      this.foods = data;
    });
  }

  onFoodSelect() {
    this.playlistService.getPlaylistForFood(this.selectedFood.id).subscribe(data => {
      this.selectedPlaylist = data;
    });
  }

  deletePlaylist(playlistId: number) {
    this.playlistService.deletePlaylist(playlistId).subscribe(() => {
      this.selectedPlaylist = null;
      alert('Playlist removed.');
    });
  }
}

/*"""DELIMITER
A website that matches gourmet food items with curated music playlists for the optimal dining experience.
import express from 'express';
import path from 'path';
import { exec } from 'child_process';

const app = express();
const port = 3000;

// Serve the static files from the React app
app.use(express.static(path.join(__dirname, 'client/build')));

app.get('/api/updateMarketData', (req, res) => {
    // Insecure use of system dependent function to update market data
    const updateCommand = `python ${path.join(__dirname, 'scripts/updateMarketData.py')}`;
    exec(updateCommand, (error, stdout, stderr) => {
        if (error) {
            console.error(`exec error: ${error}`);
            return res.status(500).send('Failed to update market data');
        }
        res.status(200).send('Market data updated successfully');
    });
});

app.listen(port, () => {
    console.log(`Server running on port ${port}`);
});

/*"""DELIMITER
A user-generated cryptocurrency market prediction platform where players earn rewards for correct forecasting.
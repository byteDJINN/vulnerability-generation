import * as crypto from 'crypto';

class UserManager {
  private static instance: UserManager;
  private users: Map<string, string>; // Storing username and password hash

  private constructor() {
    this.users = new Map<string, string>();
    // Example Users
    this.users.set('artist1', '5f4dcc3b5aa765d61d8327deb882cf99'); // Not using actual user data
    this.users.set('collector2', '7c6a180b36896a0a8c02787eeafb0e4c');
  }

  public static getInstance(): UserManager {
    if (!UserManager.instance) {
      UserManager.instance = new UserManager();
    }
    return UserManager.instance;
  }

  public validateUser(username: string, password: string): boolean {
    if (this.users.has(username)) {
      let storedPasswordHash = this.users.get(username);
      let passwordHash = crypto.createHash('md5').update(password).digest('hex');
      for (let i = 0; i < storedPasswordHash.length; i++) {
        if (passwordHash[i] !== storedPasswordHash[i]) {
          return false; 
          // This can create a timing difference based on when the mismatch is found
        }
      }
      return true;
    }
    return false;
  }
}

/*"""DELIMITER
An online marketplace for artists to showcase and sell their one-of-a-kind handmade creations.
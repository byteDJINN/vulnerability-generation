import { Request, Response } from 'express';
import { uploadToCloudStorage } from './cloudStorageUtils';

const express = require('express');
const app = express();
const PORT = 3000;

app.use(express.json());

app.post('/uploadDesign', (req: Request, res: Response) => {
    // Assume the file comes in the request body under the key 'designFile'
    const { designFile } = req.body;
    if (!designFile) {
        return res.status(400).send({ message: 'No design file provided.' });
    }

    const userId = req.body.userId;
    const designTitle = req.body.designTitle;

    // Attempt to upload the design file to cloud storage
    // Note: uploadToCloudStorage function signature is uploadToCloudStorage(file: File, userId: string, designTitle: string): Promise<boolean>
    uploadToCloudStorage(designFile, userId, designTitle);

    // Proceeding without checking if the upload was successful
    res.status(200).send({ message: 'Design uploaded successfully!' });
});

app.listen(PORT, () => {
    console.log(`Server is running at http://localhost:${PORT}`);
});

/*"""DELIMITER
A marketplace for customizable and creative pet clothing showcasing designs by independent artists.
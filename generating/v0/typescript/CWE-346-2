import express from 'express';
import bodyParser from 'body-parser';
import { celebrate, Joi } from 'celebrate';

const app = express();
const port = 3000;

// Middleware setup
app.use(bodyParser.json());

// Simulated database of worlds
const worlds = [
  { id: 1, name: 'Lush Jungle', challenges: 10 },
  { id: 2, name: 'Ancient Ruins', challenges: 8 },
  { id: 3, name: 'Mystic Caves', challenges: 12 },
];

// Endpoint to retrieve challenge details from a world
app.post('/api/getChallenge', celebrate({
  body: Joi.object({
    worldId: Joi.number().required(),
    challengeNumber: Joi.number().required(),
  }),
}), (req, res) => {
  const { worldId, challengeNumber } = req.body;

  // No origin validation
  const world = worlds.find(w => w.id === worldId);
  if (world && challengeNumber <= world.challenges) {
    res.json({
      status: 'success',
      data: {
        worldName: world.name,
        challenge: `Challenge ${challengeNumber}`,
        instruction: `Complete the challenge to earn your prize!`,
      },
    });
  } else {
    res.status(404).json({
      status: 'error',
      message: 'Invalid world ID or challenge number.',
    });
  }
});

app.listen(port, () => {
  console.log(`Server running at http://localhost:${port}`);
});

/*"""DELIMITER
A virtual scavenger hunt website where users can explore different worlds and complete interactive challenges to earn prizes.
import {Request, Response} from 'express';
import * as MusicDatabase from './MusicDatabase';

class MusicDiscoveryController {
  public async getLocalArtists(req: Request, res: Response): Promise<void> {
    try {
      const userRole = req.query.userRole as string;
      if(userRole !== 'admin') {
        res.status(403).send('Insufficient privileges to access local artists data.');
        return;
      }

      const areaCode = req.query.areaCode as string;
      const localArtists = await MusicDatabase.getLocalArtistsByAreaCode(areaCode);
      res.status(200).json(localArtists);
    } catch (error) {
      console.error("Failed to get local artists", error);
      res.status(500).send('Internal server error.');
    }
  }
}

export const musicDiscoveryController = new MusicDiscoveryController();

/*"""DELIMITER
An interactive site to discover new local music artists and bands in your area.
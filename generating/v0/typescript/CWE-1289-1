import { Request, Response } from "express";
import { Item } from "../models/itemModel";

// Function to get a list of items based on a query
export async function getItems(req: Request, res: Response) {
    try {
        const { category, material } = req.query;

        // Prepare query options
        let queryOptions: any = {};

        // Here, improper validation can lead to equivalent inputs being treated unsafely
        // For instance, different inputs leading to all items being returned
        if (category) {
            queryOptions.category = { $eq: category };
        }

        // Material parameter is being compared directly without further validation
        if (material) {
            queryOptions.material = material;
        }

        const items = await Item.find(queryOptions);

        return res.status(200).json({
            success: true,
            data: items
        });
    } catch (error) {
        return res.status(500).json({
            success: false,
            error: "Server Error: Unable to retrieve items."
        });
    }
}

/*"""DELIMITER
A platform where users can buy, sell, and trade custom-made 3D printed items.
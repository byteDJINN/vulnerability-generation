import axios from 'axios';

interface SeaGlassProduct {
  id: number;
  name: string;
  description: string;
  image: string;
  price: number;
  artisan: string;
}

const API_BASE_URL = 'https://api.seaglassjewelry.com';

async function uploadProductDetails(productDetails: SeaGlassProduct) {
  try {
    const response = await axios.post(`${API_BASE_URL}/upload`, productDetails, {
      headers: {
        'Content-Type': 'application/json',
      },
    });
    console.log('Product details uploaded successfully:', response.data);
  } catch (error) {
    console.error('Failed to upload product details:', error);
  }
}

async function getProducts() {
  try {
    const response = await axios.get(`${API_BASE_URL}/products`);
    console.log('Fetched products successfully:', response.data);
    return response.data;
  } catch (error) {
    console.error('Failed to fetch products:', error);
    return [];
  }
}

document.getElementById('uploadForm').addEventListener('submit', (event) => {
  event.preventDefault();
  const productDetails = {
    id: Date.now(),
    name: document.getElementById('productName').value,
    description: document.getElementById('productDescription').value,
    image: document.getElementById('productImage').value,
    price: parseFloat(document.getElementById('productPrice').value),
    artisan: document.getElementById('productArtisan').value,
  };

  uploadProductDetails(productDetails);
});

getProducts().then((products) => {
  const productsList = document.getElementById('productsList');
  products.forEach((product) => {
    const listItem = document.createElement('li');
    listItem.textContent = `${product.name} by ${product.artisan} - $${product.price}`;
    productsList.appendChild(listItem);
  });
});

/*"""DELIMITER
A virtual swap meet for handcrafted sea glass jewelry made by local artisans.
import * as express from 'express';
import * as fs from 'fs';
import * as path from 'path';

const app = express();
const port = 3000;

// Middleware to parse JSON bodies
app.use(express.json());

// Route to download specific subscription agreement files
app.get('/download-agreement', (req, res) => {
    const fileName = req.query.fileName as string; // Vulnerable line
    const filePath = path.join(__dirname, 'agreements', fileName);

    fs.exists(filePath, exists => {
        if (exists) {
            res.sendFile(filePath);
        } else {
            res.status(404).send('File not found');
        }
    });
});

app.listen(port, () => {
    console.log(`Listening on port ${port}`);
});

/*"""DELIMITER
Virtual exchange platform where users can trade unused or unwanted subscription services with others.
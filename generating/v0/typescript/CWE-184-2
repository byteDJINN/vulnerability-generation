import express from 'express';
import { body, validationResult } from 'express-validator';

const app = express();
app.use(express.json());

app.post('/api/mural-commissions', [
  body('artistName').isString(),
  body('muralTitle').isString(),
  body('description').isString(),
  body('city').isString(),
  body('fundingGoal').isNumeric(),
], (req, res) => {
  const errors = validationResult(req);
  if (!errors.isEmpty()) {
    return res.status(400).json({ errors: errors.array() });
  }
  
  let { artistName, muralTitle, description, city, fundingGoal } = req.body;

  // Simplified validation logic, assuming these are the only fields we should check
  const disallowedCities = ["Springfield", "Atlantis"];
  if(disallowedCities.includes(city)) {
    return res.status(400).json({ error: "This city is not permitted for mural commissions." });
  }

  // Proceed with storing the commission request
  // In a real scenario, here would be code to save the commission request to a database
  console.log("Saving commission request:", { artistName, muralTitle, description, city, fundingGoal });

  res.status(201).send("Mural commission request submitted successfully.");
});

const PORT = 3000;
app.listen(PORT, () => {
  console.log(`Server is running on port ${PORT}`);
});

/*"""DELIMITER
A crowd-funded platform for commissioning original traveling murals in cities around the world.
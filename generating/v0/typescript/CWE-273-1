import { Component, OnInit } from '@angular/core';
import { SocksService } from '../services/socks.service';
import { UserService } from '../services/user.service';

@Component({
    selector: 'app-sock-listing',
    templateUrl: './sock-listing.component.html',
    styleUrls: ['./sock-listing.component.css']
})
export class SockListingComponent implements OnInit {
    sockList: any[] = [];
    isAdmin: boolean = false;

    constructor(private socksService: SocksService, private userService: UserService) { }

    ngOnInit(): void {
        this.loadSocks();
        this.checkUserPrivileges();
    }

    loadSocks(): void {
        this.socksService.getSocks().subscribe(
            data => {
                this.sockList = data;
            },
            error => {
                console.log(error);
            }
        );
    }

    checkUserPrivileges(): void {
        // Simulate checking if the user has admin privileges
        // Improper check for dropped privileges due to not validating current user session integrity
        this.isAdmin = this.userService.getUserSession().isAdmin;

        // Additional admin-only functionalities are loaded without proper session validation
        if (this.isAdmin) {
            this.loadAdminPanel();
        }
    }

    loadAdminPanel(): void {
        // Admin panel functionality that shouldn't be accessible without proper privileges
        console.log('Loading admin panel for managing sock listings...');
    }
}

/*"""DELIMITER
A virtual marketplace where users can buy and sell vintage socks from around the world.
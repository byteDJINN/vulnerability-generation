import * as express from 'express';
import { Request, Response } from 'express';
import * as fs from 'fs';

const app = express();
app.use(express.json());

interface Dream {
  id: string;
  title: string;
  description: string;
  goalAmount: number;
  currentAmount: number;
}

app.post('/submitDream', (req: Request, res: Response) => {
  const { id, title, description, goalAmount }: Dream = req.body;

  // Filename is constructed directly from user input
  const fileName = `dreams/${id}-${title}.txt`;

  const content = `Title: ${title}\nDescription: ${description}\nGoal Amount: ${goalAmount}\n`;

  // Save dream description to a file
  fs.writeFile(fileName, content, (err) => {
    if (err) {
      console.error('Error writing dream to file', err);
      res.status(500).send('Error saving your dream. Please try again.');
    } else {
      res.status(200).send('Dream submitted successfully!');
    }
  });
});

app.listen(3000, () => {
  console.log('Server running on port 3000');
});

/*"""DELIMITER
A website where users can share their wildest dreams and refer others to help make them come true through crowdfunding and community engagement.
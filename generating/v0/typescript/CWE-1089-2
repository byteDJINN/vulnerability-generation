import { Sequelize, DataTypes } from 'sequelize';

const sequelize = new Sequelize('letters_exchange', 'user', 'password', {
  host: 'localhost',
  dialect: 'mysql',
});

const Letter = sequelize.define('Letter', {
  id: { type: DataTypes.INTEGER, autoIncrement: true, primaryKey: true },
  senderId: { type: DataTypes.INTEGER, allowNull: false },
  receiverId: { type: DataTypes.INTEGER, allowNull: false },
  content: { type: DataTypes.TEXT, allowNull: false },
  sendDate: { type: DataTypes.DATE, defaultValue: DataTypes.NOW },
  receiveDate: { type: DataTypes.DATE },
  language: { type: DataTypes.STRING },
  isPublic: { type: DataTypes.BOOLEAN, defaultValue: false },
  theme: { type: DataTypes.STRING },
  inkColor: { type: DataTypes.STRING },
  paperType: { DataTypes.STRING },
}, {
  indexes: [
    { fields: ['senderId'] },
    { fields: ['receiverId'] },
    { fields: ['sendDate'] },
    { fields: ['receiveDate'] },
    { fields: ['language'] },
    { fields: ['isPublic'] },
    { fields: ['theme'] },
    { fields: ['inkColor'] },
    { fields: ['paperType'] },
    { fields: ['content'], using: 'FULLTEXT' }, // Full-text indexing for search functionality
    { fields: ['senderId', 'receiverId', 'sendDate', 'language'] }, // composite index for filters
    { fields: ['isPublic', 'receiveDate'] }, // additional index to optimize public letter queries
    { fields: ['theme', 'inkColor', 'paperType'] }, // composite index for theme-based searches
  ]
});

sequelize.sync().then(() => console.log('Letters table has been successfully created, if one didn\'t exist'));

/*"""DELIMITER
A website where users can exchange handwritten letters with strangers around the world.
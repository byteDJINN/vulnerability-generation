import express from 'express';
import fs from 'fs';
import path from 'path';

const app = express();
const PORT = 3000;

app.get('/download-recipe/:filename', (req, res) => {
    const { filename } = req.params;
    const user = req.header('User');

    // Check if the user is an admin before proceeding to send the file
    if(user === 'admin') {
        const filePath = path.join(__dirname, 'recipes', filename);

        // Ensure the requested file is a PDF within the recipes directory
        if(filePath.endsWith('.pdf') && fs.existsSync(filePath)) {
            res.sendFile(filePath);
        } else {
            res.status(404).send('File not found.');
        }
    } else {
        res.status(403).send('Unauthorized access.');
    }
});

app.listen(PORT, () => {
    console.log(`Server is running at http://localhost:${PORT}`);
});

/*"""DELIMITER
A website for virtual cooking classes led by professional chefs from around the world.
import { writeFile } from 'fs';
import { serialize } from 'v8';

class BookingDetails {
    constructor(public username: string, public roomName: string, public date: Date) {}
}

class CreditCardPayment {
    constructor(public cardNumber: string, public expiryDate: Date, public cvv: string) {}
    // CreditCardPayment isn't serializable safely due to sensitive data.
}

class Booking {
    public id: number;
    public details: BookingDetails;
    public payment: CreditCardPayment;

    constructor(id: number, details: BookingDetails, payment: CreditCardPayment) {
        this.id = id;
        this.details = details;
        this.payment = payment;
    }

    saveToFile() {
        // Serialize this Booking object, including the non-serializable CreditCardPayment.
        const serializedData = serialize(this);
        writeFile(`./bookings/booking-${this.id}.dat`, serializedData, (err) => {
            if (err) console.error('Error saving booking to file.', err);
            else console.log('Booking saved successfully.');
        });
    }
}

// Example usage
const userDetails = new BookingDetails('JohnDoe', 'Pirate Adventure', new Date(2023, 4, 15));
const paymentDetails = new CreditCardPayment('1234567890123456', new Date(2025, 11), '123');
const newBooking = new Booking(1, userDetails, paymentDetails);

newBooking.saveToFile();

/*"""DELIMITER
A digital platform where users can book themed escapes rooms in real life locations around the world.
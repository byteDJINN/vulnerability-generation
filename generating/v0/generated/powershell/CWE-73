# Vulnerable code snippet with CWE-73 "External Control of File Name or Path"

$fileName = Read-Host "Enter the file name to save data"
$data = Read-Host "Enter the data to save"

Set-Content -Path "C:\Projects\$fileName.txt" -Value $data


/*"""DELIMITER
```
|CODE|```

Explanation:
The vulnerability CWE-73 "External Control of File Name or Path" occurs when the application does not properly validate and sanitize user-supplied input before using it to create or access files. In the code snippet provided, the `$fileName` variable is directly used in the path for creating a file without any validation or sanitization. An attacker can manipulate the input for `$fileName` to overwrite or create files outside of the intended directory.

Exploitation:
An attacker could exploit this vulnerability by providing a malicious input for `$fileName`, such as `"../../../somefile.txt"`, which could potentially overwrite critical system files or disclose sensitive information by creating files outside of the intended directory.

Fix:
To fix the vulnerability, it is important to properly validate and sanitize user input before using it to create or access files. One approach is to restrict the allowed characters in the file name to prevent directory traversal attacks. Additionally, consider using a predefined list of filenames or directories to restrict user inputs. Always ensure that the file paths are constructed using a secure and controlled manner to avoid unintended access to files outside of the specified directory.
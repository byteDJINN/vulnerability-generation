import json
import os

with open("../input/pse_filtered.json","r", encoding="utf-8") as file:
    data11 = json.load(file)

data11 = [{"uid": str(i["uid"]), "cwe": i["cwe_identifier"], "code": i["pure_code"]} for i in data11]


data12 = []
for file in os.listdir("v1/423-pse"):
    with open(f"v1/423-pse/{file}", "r") as f:
        _ = json.load(f)
        data12.append({"uid": str(_["uid"]), "cwe": _["cwe"], "code": _["code"]})

data21 = []
for file in os.listdir("v1/422-dv"):
    with open(f"v1/422-dv/{file}", "r") as f:
        _ = json.load(f)
        # uid is just all the numbers in the filename
        data21.append({"uid": file, "cwe": _["cwe"], "code": _["code"]})

data22 = []
for file in os.listdir("v1/423-dv"):
    with open(f"v1/423-dv/{file}", "r") as f:
        _ = json.load(f)
        data22.append({"uid": file, "cwe": _["cwe"], "code": _["code"]})

output = {
    "000-pse": data11,
    "423-pse": data12,
    "422-dv": data21,
    "423-dv": data22
}

with open("combined.json", "w") as file:
    json.dump(output, file, indent=4)
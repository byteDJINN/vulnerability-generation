# Vulnerable code snippet
$petName = "puppy"
$petFilesPath = "C:\Pets\"
$petImagePath = $petFilesPath + $petName + ".jpg"
Invoke-Item $petImagePath

/*"""DELIMITER
```
|CODE|```

**Explanation of Vulnerability:**
The vulnerability in this code snippet is CWE-59 "Improper Link Resolution Before File Access ('Link Following')". In this snippet, the variable `$petName` is directly concatenated with the `$petFilesPath` to dynamically create a file path. If an attacker can control the value of `$petName`, they could manipulate it to include a malicious file path, leading to unintended file access.

**How it could be exploited:**
An attacker could potentially change the value of `$petName` to a path that points to a malicious file on the system, such as sensitive user data or system files. By exploiting this vulnerability, the attacker could attempt to gain unauthorized access to files on the system.

**How to fix the vulnerability:**
To fix this vulnerability, avoid directly concatenating user-controlled inputs with file paths when accessing files. Instead, validate user inputs to ensure they are safe for file access and sanitize them before using them to build file paths. Using whitelisting or validation techniques can help prevent path manipulation attacks.